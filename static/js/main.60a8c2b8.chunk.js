(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{49:function(e,n,t){e.exports=t(72)},69:function(e,n,t){},70:function(e,n,t){},72:function(e,n,t){"use strict";t.r(n);var a=t(31),r=t.n(a),o=t(38),u=t(8),c=t(19),i=t(23),s=t(75),m=t(0),l=t.n(m),d=t(9),b=t(39),f=t.n(b),p=t(17),v=t(30),E=t(10),g=t(48),h=t(42),j=t(2),O=t(18),w=t(46),_=new g.a({uri:"https://graphql-number-guessing-game.herokuapp.com/v1/graphql"}),$=new h.a({uri:"wss://graphql-number-guessing-game.herokuapp.com/v1/graphql",options:{reconnect:!0}}),N=Object(E.d)(function(e){var n=e.query,t=Object(j.l)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation},$,_),S=new O.a({link:N,cache:new w.a}),q=t(12),I=t(13),C=t.n(I);function k(){var e=Object(q.a)(["\n  mutation NextRound($roomId: uuid) {\n    update_room(_inc: { round: 1 }, where: { id: { _eq: $roomId } }) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return k=function(){return e},e}function y(){var e=Object(q.a)(["\n  mutation SubmitQuestion(\n    $roomId: uuid!\n    $name: String\n    $description: String\n    $imageUrl: String\n    $answer: json\n  ) {\n    insert_question(\n      objects: [\n        {\n          room_id: $roomId\n          name: $name\n          description: $description\n          imageUrl: $imageUrl\n          answer: $answer\n        }\n      ]\n    ) {\n      affected_rows\n      returning {\n        id\n        name\n      }\n    }\n  }\n"]);return y=function(){return e},e}function x(){var e=Object(q.a)(["\n  mutation CreateRoomAndUser($userName: String, $roomName: String) {\n    insert_user(\n      objects: [{ name: $userName, room: { data: { name: $roomName } } }]\n    ) {\n      affected_rows\n      returning {\n        id\n        name\n        room {\n          name\n          id\n        }\n      }\n    }\n  }\n"]);return x=function(){return e},e}function U(){var e=Object(q.a)(["\n  subscription SubscribeToAnswer($questionId: uuid, $userId: uuid) {\n    response(\n      where: { question_id: { _eq: $questionId }, owner_id: { _eq: $userId } }\n      order_by: { created_at: desc }\n      limit: 1\n    ) {\n      id\n      value\n      question {\n        name\n        answer\n      }\n    }\n  }\n"]);return U=function(){return e},e}function R(){var e=Object(q.a)(["\n  mutation SubmitAnswer($questionId: uuid, $userId: uuid, $value: Int) {\n    insert_response(\n      objects: [{ question_id: $questionId, owner_id: $userId, value: $value }]\n    ) {\n      affected_rows\n      returning {\n        id\n        value\n      }\n    }\n  }\n"]);return R=function(){return e},e}function A(){var e=Object(q.a)(["\n  query GetAnswer($questionId: uuid, $userId: uuid) {\n    response(\n      limit: 1\n      where: { question_id: { _eq: $questionId }, owner_id: { _eq: $userId } }\n    ) {\n      id\n      value\n    }\n  }\n"]);return A=function(){return e},e}function D(){var e=Object(q.a)(["\n  query FindRoomByName($name: String) {\n    room(where: { name: { _eq: $name } }) {\n      id\n      name\n    }\n  }\n"]);return D=function(){return e},e}function F(){var e=Object(q.a)(["\n  subscription SubscribeToRoom($name: String) {\n    room(where: { name: { _eq: $name } }) {\n      id\n      state\n      name\n      round\n      questions(order_by: { created_at: asc }) {\n        id\n        name\n        state\n        created_at\n        answer\n        room {\n          id\n          round\n        }\n        responses {\n          value\n          owner {\n            id\n            name\n          }\n        }\n      }\n      users {\n        id\n        name\n      }\n    }\n  }\n"]);return F=function(){return e},e}function T(){var e=Object(q.a)(["\n  subscription SubscribeToRoom($roomId: uuid!) {\n    room_by_pk(id: $roomId) {\n      questions(order_by: { created_at: desc }) {\n        id\n        name\n        created_at\n        answer\n        responses {\n          value\n          owner {\n            name\n          }\n        }\n      }\n      users {\n        id\n        name\n      }\n    }\n  }\n"]);return T=function(){return e},e}function M(){var e=Object(q.a)(["\n  query Room($name: String) {\n    room(where: { name: { _eq: $name } }, distinct_on: name) {\n      id\n      name\n      questions(order_by: { created_at: desc }) {\n        id\n        name\n        created_at\n        answer\n        responses {\n          value\n          owner {\n            name\n          }\n        }\n      }\n      users {\n        id\n        name\n      }\n    }\n  }\n"]);return M=function(){return e},e}function Q(){var e=Object(q.a)(["\n  query UsersInRoomQuery($roomName: String) {\n    user(where: { room: { name: { _eq: $roomName } } }) {\n      id\n      name\n    }\n  }\n"]);return Q=function(){return e},e}function B(){var e=Object(q.a)(["\n  subscription UsersInRoomSubscription($roomName: String) {\n    user(where: { room: { name: { _eq: $roomName } } }) {\n      id\n      name\n    }\n  }\n"]);return B=function(){return e},e}function z(){var e=Object(q.a)(["\n  mutation CreateUser($name: String, $roomId: uuid) {\n    insert_user(objects: [{ name: $name, room_id: $roomId }]) {\n      affected_rows\n      returning {\n        id\n        name\n        room {\n          name\n          id\n        }\n      }\n    }\n  }\n"]);return z=function(){return e},e}var J=C()(z()),P=(C()(B()),C()(Q()),C()(M()),C()(T()),C()(F())),G=C()(D()),L=(C()(A()),C()(R())),W=(C()(U()),C()(x())),Y=C()(y()),H=C()(k()),K=t(47),V=function(e){var n=e.component,t=e.loggedIn,a=e.path,r=Object(K.a)(e,["component","loggedIn","path"]);return l.a.createElement(p.b,Object.assign({path:a},r,{render:function(e){return t?l.a.createElement(n,e):l.a.createElement(p.a,{to:"/"})}}))},X=(t(69),t(70),l.a.createContext()),Z=function(e){var n=e.handleSubmit,t=Object(m.useState)(null),a=Object(u.a)(t,2),r=a[0],o=a[1],c=Object(m.useState)(null),i=Object(u.a)(c,2),s=i[0],d=i[1];return console.log("name",s),l.a.createElement("form",{onSubmit:function(e){return n(e,{name:s,code:r})}},l.a.createElement("div",{className:"form-field",j:!0},l.a.createElement("label",{htmlFor:"name-input",className:"form-label"},"NAME"),l.a.createElement("input",{id:"name-input",value:s,onChange:function(e){return d(e.target.value)},placeholder:"Name"})),l.a.createElement("div",{className:"form-field"},l.a.createElement("label",{htmlFor:"room-input",className:"form-label"},"ROOM"),l.a.createElement("input",{id:"room-input",value:r,onChange:function(e){return o(e.target.value)},placeholder:"Room Code"})),l.a.createElement("div",{className:"btn-group"},l.a.createElement("button",{className:"btn"},"go back"),l.a.createElement("button",{className:"btn"},"submit")))},ee=function(e){var n=e.handleSubmit,t=Object(m.useState)(null),a=Object(u.a)(t,2),r=a[0],o=a[1],c=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,4).toUpperCase(),i=Object(p.g)();return l.a.createElement("form",{onSubmit:function(e){return n(e,{name:r,code:c})}},l.a.createElement("div",{className:"form-field"},l.a.createElement("label",{htmlFor:"name-input",className:"form-label"},"NAME"),l.a.createElement("input",{id:"name-input",value:r,onChange:function(e){return o(e.target.value)},placeholder:"Name"})),l.a.createElement("div",{className:"btn-group"},l.a.createElement("button",{onClick:function(){i.push("/")},className:"btn"},"go back"),l.a.createElement("button",{className:"btn"},"submit")))},ne=function(e){var n=e.data,t=e.responses;return l.a.createElement("div",null,n.map(function(e){var n=i.a([i.b({owner:{id:e.id}})],t),a=n?"badge":"badge-gray";return console.log(a),console.log("answered?",e,t,n),l.a.createElement("span",{className:a,key:e.id},e.name)}))},te=function(e){var n=e.guess,t=e.answer;return l.a.createElement("div",null,l.a.createElement("div",null,"Your Answer: ",n),l.a.createElement("div",null,"Correct Answer: ",t),l.a.createElement("div",null,"Score: ",function(e,n){return e===n?-5:Math.abs(n-e)}(n,t)))},ae=function(e){var n=e.data,t=e.roundOver,a=Object(m.useContext)(X).user,r=Object(m.useState)(null),o=Object(u.a)(r,2),s=o[0],d=o[1],b=Object(c.b)(L),f=Object(u.a)(b,1)[0],p=Object(c.b)(H),v=Object(u.a)(p,1)[0],E=i.a([i.b({owner:{id:a.id}})],n.responses);return E?n.answer&&t?l.a.createElement(l.a.Fragment,null,l.a.createElement(te,{guess:E.value,answer:n.answer.score.rottenTomatoes}),l.a.createElement("button",{className:"btn",onClick:function(){v({variables:{roomId:n.room.id}})}},"next round")):l.a.createElement("div",null,l.a.createElement("span",null,"Current Answer: ",E.value),l.a.createElement("button",{className:"btn"},"end round")):l.a.createElement("div",null,l.a.createElement("h3",null,"Question id: ",n.id),l.a.createElement("h3",null,"User ID: ",a.id),l.a.createElement("span",null,a.name,"'s answer:"),l.a.createElement("form",{onSubmit:function(e){e.preventDefault(),f({variables:{userId:a.id,questionId:n.id,value:s}})}},l.a.createElement("input",{placeholder:"Answer",onChange:function(e){return d(e.target.value)},value:s}),l.a.createElement("button",{className:"btn"},"submit")))},re=function(e){var n=e.data,t=e.nUsers,a=e.roomId,i=Object(m.useState)(null),s=Object(u.a)(i,2),d=s[0],b=s[1],f=Object(c.b)(Y),p=Object(u.a)(f,1)[0],v=Object(m.useState)(!1),E=Object(u.a)(v,2),g=E[0],h=E[1];if(console.log("data.responses",n),Object(m.useEffect)(function(){n&&t===n.responses.length?h(!0):h(!1)},[n]),n)return l.a.createElement(l.a.Fragment,null,l.a.createElement("h3",null,"Question: ",n.name),l.a.createElement("h4",null,"Question State: ",n.state),l.a.createElement(ae,{data:n,roundOver:g}));return l.a.createElement("div",null,l.a.createElement("form",{className:"flex flex-row",onSubmit:function(e){var n;e.preventDefault(),fetch((n=d,"https://kha9mwfrdb.execute-api.us-east-1.amazonaws.com/dev/search/".concat(n))).then(function(){var e=Object(o.a)(r.a.mark(function e(n){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:t=e.sent,console.log("here2",t),p({variables:{roomId:a,description:t.description,imageUrl:t.poster,name:t.title,answer:t.reception}}),b(null);case 6:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()).catch(function(e){console.error("error!",e)})}},l.a.createElement("div",{className:"flex flex-row"},l.a.createElement("input",{placeholder:"Search movie titles...",value:d,className:"attached-right shadow-none",onChange:function(e){return b(e.target.value)}}),l.a.createElement("button",{className:"btn attached-left"},"submit"))))},oe=function(e){var n=e.data;return l.a.createElement("div",null,l.a.createElement("h1",null,n.name),l.a.createElement("h3",null,"Room ID: ",n.id),l.a.createElement("h4",null,"State: ",n.state),l.a.createElement(re,{data:n.questions[n.round],roomId:n.id,nUsers:n.users.length}),l.a.createElement(ne,{data:n.users,responses:s.a([],"responses",n.questions[n.round])}))},ue=function(e){var n=e.match.params.name,t=Object(c.c)(P,{variables:{name:n}});return t.loading?"Loading...":l.a.createElement(oe,{data:t.data.room[0]})},ce=function(){var e=Object(m.useState)(),n=Object(u.a)(e,2),t=n[0],a=n[1],r=Object(m.useContext)(X),o=r.user,i=r.setUser,s=Object(m.useState)(),d=Object(u.a)(s,2),b=d[0],f=d[1],v=Object(m.useState)({}),E=Object(u.a)(v,2),g=E[0],h=E[1],j=Object(p.g)(),O=Object(c.b)(J),w=Object(u.a)(O,2),_=w[0],$=w[1],N=Object(c.a)(G),S=Object(u.a)(N,2),q=S[0],I=S[1],C=Object(c.b)(W),k=Object(u.a)(C,2),y=k[0],x=k[1];Object(m.useEffect)(function(){I.loading||I.data&&I.data.room.length&&h(I.data.room[0])},[I]),Object(m.useEffect)(function(){g.id&&_({variables:{name:b,roomId:g.id}})},[g.id,b,_]),Object(m.useEffect)(function(){$.data&&i($.data.insert_user.returning[0])},[$.data,i,j]),Object(m.useEffect)(function(){o&&j.push("/game/".concat(o.room.name))},[o,j]),Object(m.useEffect)(function(){x.data&&i(x.data.insert_user.returning[0])},[x]);var U=function(e,n){var a=n.name,r=n.code;e.preventDefault(),"join"===t?(q({variables:{name:r}}),f(a)):"create"===t&&y({variables:{userName:a,roomName:r}})};return t?"join"===t?l.a.createElement(Z,{handleSubmit:U}):"create"===t?l.a.createElement(ee,{handleSubmit:U}):void 0:l.a.createElement("div",{className:"flex flex-col justify-center items-center"},l.a.createElement("div",{className:" pb-5/6 rounded-lg"},l.a.createElement("img",{className:"object-cover rounded-lg shadow-md",src:"https://i.kinja-img.com/gawker-media/image/upload/s--vMJWT-nB--/c_scale,f_auto,fl_progressive,q_80,w_800/mdc4jnl2amnpmnajblxn.jpg"})),l.a.createElement("div",{className:"p-6 bg-white relative  -mt-10 rounded-lg shadow-lg z-0"},l.a.createElement("h1",null,"Do you want to play a game?"),l.a.createElement("div",{className:"btn-group"},l.a.createElement("button",{className:"btn",onClick:function(){return a("create")}},"create"),l.a.createElement("button",{className:"btn",onClick:function(){return a("join")}},"join"))))},ie=function(e){var n=e.children,t=Object(m.useState)(),a=Object(u.a)(t,2),r=a[0],o=a[1];return l.a.createElement(X.Provider,{value:{user:r,setUser:o}},n)},se=function(){var e=[{name:"Carol",id:"carol-id"},{name:"Bob",id:"bob-id"}];return l.a.createElement(X.Provider,{value:{user:{id:"user-id",name:"Frank"}}},l.a.createElement(p.b,{path:"/components/join",component:Z}),l.a.createElement(p.b,{path:"/components/create",component:ee}),l.a.createElement(p.b,{path:"/components/users"},l.a.createElement(ne,{data:e})),l.a.createElement(p.b,{path:"/components/question"},l.a.createElement(ae,{data:{id:"some-id"}})),l.a.createElement(p.b,{path:"/components/room"},l.a.createElement(oe,{data:{questions:[{name:"The Terminal",responses:[{owner:{id:"carol-id"}}]}],round:0,users:e}})))},me=function(){var e=Object(m.useContext)(X).user;return l.a.createElement("div",{className:"app"},l.a.createElement(p.b,{path:"/",exact:!0},l.a.createElement("div",{className:"form-container"},l.a.createElement(ce,null))),l.a.createElement(se,null),l.a.createElement(V,{path:"/game/:name",component:ue,loggedIn:!!e}))};var le=document.getElementById("root");f.a.render(l.a.createElement(function(){return l.a.createElement(d.a,{client:S},l.a.createElement(ie,null,l.a.createElement(v.a,{basename:"/"},l.a.createElement(p.d,null,l.a.createElement(me,null)))))},null),le)}},[[49,1,2]]]);
//# sourceMappingURL=main.60a8c2b8.chunk.js.map