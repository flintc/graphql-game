(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{59:function(e,n,t){e.exports=t(82)},79:function(e,n,t){},80:function(e,n,t){},82:function(e,n,t){"use strict";t.r(n);var a=t(41),r=t.n(a),o=t(48),c=t(11),i=t(24),s=t(25),u=t(87),m=t(90),l=t(86),d=t(85),b=t(89),p=t(88),f=t(91),h=t(0),g=t.n(h),v=t(12),E=t(49),w=t.n(E),j=t(22),O=t(40),N=t(13),$=t(58),_=t(52),q=t(2),x=t(23),S=t(56),I=new $.a({uri:"https://graphql-number-guessing-game.herokuapp.com/v1/graphql"}),y=new _.a({uri:"wss://graphql-number-guessing-game.herokuapp.com/v1/graphql",options:{reconnect:!0}}),k=Object(N.d)(function(e){var n=e.query,t=Object(q.l)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation},y,I),C=new x.a({link:k,cache:new S.a}),U=t(15),A=t(16),M=t.n(A);function R(){var e=Object(U.a)(["\n  mutation NextRound($roomId: uuid) {\n    update_room(_inc: { round: 1 }, where: { id: { _eq: $roomId } }) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return R=function(){return e},e}function T(){var e=Object(U.a)(["\n  mutation SubmitQuestion(\n    $roomId: uuid!\n    $name: String\n    $description: String\n    $imageUrl: String\n    $answer: json\n  ) {\n    insert_question(\n      objects: [\n        {\n          room_id: $roomId\n          name: $name\n          description: $description\n          imageUrl: $imageUrl\n          answer: $answer\n        }\n      ]\n    ) {\n      affected_rows\n      returning {\n        id\n        name\n      }\n    }\n  }\n"]);return T=function(){return e},e}function B(){var e=Object(U.a)(["\n  mutation CreateRoomAndUser($userName: String, $roomName: String) {\n    insert_user(\n      objects: [{ name: $userName, room: { data: { name: $roomName } } }]\n    ) {\n      affected_rows\n      returning {\n        id\n        name\n        room {\n          name\n          id\n        }\n      }\n    }\n  }\n"]);return B=function(){return e},e}function F(){var e=Object(U.a)(["\n  subscription SubscribeToAnswer($questionId: uuid, $userId: uuid) {\n    response(\n      where: { question_id: { _eq: $questionId }, owner_id: { _eq: $userId } }\n      order_by: { created_at: desc }\n      limit: 1\n    ) {\n      id\n      value\n      question {\n        name\n        answer\n      }\n    }\n  }\n"]);return F=function(){return e},e}function D(){var e=Object(U.a)(["\n  mutation SubmitAnswer($questionId: uuid, $userId: uuid, $value: Int) {\n    insert_response(\n      objects: [{ question_id: $questionId, owner_id: $userId, value: $value }]\n    ) {\n      affected_rows\n      returning {\n        id\n        value\n      }\n    }\n  }\n"]);return D=function(){return e},e}function P(){var e=Object(U.a)(["\n  query GetAnswer($questionId: uuid, $userId: uuid) {\n    response(\n      limit: 1\n      where: { question_id: { _eq: $questionId }, owner_id: { _eq: $userId } }\n    ) {\n      id\n      value\n    }\n  }\n"]);return P=function(){return e},e}function G(){var e=Object(U.a)(["\n  query FindRoomByName($name: String) {\n    room(where: { name: { _eq: $name } }) {\n      id\n      name\n    }\n  }\n"]);return G=function(){return e},e}function J(){var e=Object(U.a)(["\n  subscription SubscribeToRoom($name: String) {\n    room(where: { name: { _eq: $name } }) {\n      id\n      state\n      name\n      round\n      questions(order_by: { created_at: asc }) {\n        id\n        name\n        state\n        created_at\n        answer\n        imageUrl\n        description\n        room {\n          id\n          name\n          round\n        }\n        responses {\n          value\n          owner {\n            id\n            name\n          }\n        }\n      }\n      users {\n        id\n        name\n      }\n    }\n  }\n"]);return J=function(){return e},e}function W(){var e=Object(U.a)(["\n  subscription SubscribeToRoom($roomId: uuid!) {\n    room_by_pk(id: $roomId) {\n      questions(order_by: { created_at: desc }) {\n        id\n        name\n        created_at\n        answer\n        responses {\n          value\n          owner {\n            name\n          }\n        }\n      }\n      users {\n        id\n        name\n      }\n    }\n  }\n"]);return W=function(){return e},e}function z(){var e=Object(U.a)(["\n  query Room($name: String) {\n    room(where: { name: { _eq: $name } }, distinct_on: name) {\n      id\n      name\n      questions(order_by: { created_at: desc }) {\n        id\n        name\n        created_at\n        answer\n        responses {\n          value\n          owner {\n            name\n          }\n        }\n      }\n      users {\n        id\n        name\n      }\n    }\n  }\n"]);return z=function(){return e},e}function L(){var e=Object(U.a)(["\n  query UsersInRoomQuery($roomName: String) {\n    user(where: { room: { name: { _eq: $roomName } } }) {\n      id\n      name\n    }\n  }\n"]);return L=function(){return e},e}function Q(){var e=Object(U.a)(["\n  subscription UsersInRoomSubscription($roomName: String) {\n    user(where: { room: { name: { _eq: $roomName } } }) {\n      id\n      name\n    }\n  }\n"]);return Q=function(){return e},e}function Y(){var e=Object(U.a)(["\n  mutation CreateUser($name: String, $roomId: uuid) {\n    insert_user(objects: [{ name: $name, room_id: $roomId }]) {\n      affected_rows\n      returning {\n        id\n        name\n        room {\n          name\n          id\n        }\n      }\n    }\n  }\n"]);return Y=function(){return e},e}var H=M()(Y()),K=(M()(Q()),M()(L()),M()(z()),M()(W()),M()(J())),V=M()(G()),X=(M()(P()),M()(D())),Z=(M()(F()),M()(B())),ee=M()(T()),ne=M()(R()),te=t(57),ae=function(e){var n=e.component,t=e.loggedIn,a=e.path,r=Object(te.a)(e,["component","loggedIn","path"]);return g.a.createElement(j.b,Object.assign({path:a},r,{render:function(e){return t?g.a.createElement(n,e):g.a.createElement(j.a,{to:"/"})}}))},re=(t(79),t(80),function(e,n){return e===n?-5:Math.abs(n-e)}),oe=g.a.createContext(),ce=function(e){var n=e.handleSubmit,t=Object(h.useState)(null),a=Object(c.a)(t,2),r=a[0],o=a[1],i=Object(h.useState)(null),s=Object(c.a)(i,2),u=s[0],m=s[1];return console.log("name",u),g.a.createElement("form",{onSubmit:function(e){return n(e,{name:u,code:r})}},g.a.createElement("div",{className:"form-field",j:!0},g.a.createElement("label",{htmlFor:"name-input",className:"form-label"},"NAME"),g.a.createElement("input",{id:"name-input",value:u,onChange:function(e){return m(e.target.value)},placeholder:"Name"})),g.a.createElement("div",{className:"form-field"},g.a.createElement("label",{htmlFor:"room-input",className:"form-label"},"ROOM"),g.a.createElement("input",{id:"room-input",value:r,onChange:function(e){return o(e.target.value)},placeholder:"Room Code"})),g.a.createElement("div",{className:"btn-group"},g.a.createElement("button",{className:"btn"},"go back"),g.a.createElement("button",{className:"btn"},"submit")))},ie=function(e){var n=e.handleSubmit,t=Object(h.useState)(null),a=Object(c.a)(t,2),r=a[0],o=a[1],i=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,4).toUpperCase(),s=Object(j.g)();return g.a.createElement("form",{onSubmit:function(e){return n(e,{name:r,code:i})}},g.a.createElement("div",{className:"form-field"},g.a.createElement("label",{htmlFor:"name-input",className:"form-label"},"NAME"),g.a.createElement("input",{id:"name-input",value:r,onChange:function(e){return o(e.target.value)},placeholder:"Name"})),g.a.createElement("div",{className:"btn-group"},g.a.createElement("button",{onClick:function(){s.push("/")},className:"btn"},"go back"),g.a.createElement("button",{className:"btn"},"submit")))},se=function(e){var n=e.data,t=e.responses;return g.a.createElement("div",{className:"fixed bottom-0 w-screen overflow-auto whitespace-no-wrap pb-2 px-4 text-center"},n.map(function(e){var n=s.a([s.b({owner:{id:e.id}})],t),a=n?"badge px-6 py-2 mr-4 inline-block":"badge-gray px-6 py-2 mr-4 inline-block";return console.log(a),console.log("answered?",e,t,n),g.a.createElement("span",{className:a,key:e.id},e.name)}))},ue=function(e){var n=e.guess,t=e.answer;return g.a.createElement("div",null,g.a.createElement("div",null,"Your Answer: ",n),g.a.createElement("div",null,"Correct Answer: ",t),g.a.createElement("div",null,"Score: ",re(n,t)))},me=function(e){var n=e.data,t=e.roundOver,a=e.onEndGame,r=Object(h.useContext)(oe).user,o=Object(h.useState)(null),u=Object(c.a)(o,2),m=u[0],l=u[1],d=Object(i.b)(X),b=Object(c.a)(d,1)[0],p=Object(i.b)(ne),f=Object(c.a)(p,1)[0],v=s.a([s.b({owner:{id:r.id}})],n.responses);return v?n.answer&&t?g.a.createElement(g.a.Fragment,null,g.a.createElement(ue,{guess:v.value,answer:n.answer.score.rottenTomatoes}),g.a.createElement("div",{className:"btn-group"},g.a.createElement("button",{className:"btn",onClick:function(){f({variables:{roomId:n.room.id}})}},"next round"),g.a.createElement("button",{className:"btn",onClick:a},"end game"))):g.a.createElement("div",null,g.a.createElement("span",null,"Current Answer: ",v.value),g.a.createElement("button",{className:"btn"},"end round")):(console.log("q data",n),g.a.createElement("div",{className:"shadow rounded-lg border shadow-2xl bg-white w-8/12 sm:w-2/3 lg:w-1/2 xl:w-1/3 pb-4"},g.a.createElement("div",{className:"showit relative",style:{height:"calc(55vh)"}},g.a.createElement("img",{className:"blurme absolute top-0 object-cover rounded-t-lg w-full",src:n.imageUrl,style:{height:"calc(55vh)"}}),g.a.createElement("p",{className:"p-4 absolute top-0 text-gray-800 text-lg showme rounded-t-lg w-full",style:{height:"100%",overflowY:"scroll"}},n.description)),g.a.createElement("div",{className:"rounded-b-lg p-2"},g.a.createElement("h1",{className:"text-gray-700"},n.name),g.a.createElement("form",{className:"flex flex-row w-full ",onSubmit:function(e){e.preventDefault(),b({variables:{userId:r.id,questionId:n.id,value:m}})}},g.a.createElement("input",{placeholder:"Enter your guess...",value:m,className:"attached-right shadow-none",onChange:function(e){return l(e.target.value)}}),g.a.createElement("button",{className:"btn attached-left"},"submit")))))},le=function(e){var n=e.data,t=e.nUsers,a=e.roomId,s=Object(j.g)(),u=Object(h.useState)(null),m=Object(c.a)(u,2),l=m[0],d=m[1],b=Object(i.b)(ee),p=Object(c.a)(b,1)[0],f=Object(h.useState)(!1),v=Object(c.a)(f,2),E=v[0],w=v[1];console.log("data.responses",n);if(Object(h.useEffect)(function(){n&&t===n.responses.length?w(!0):w(!1)},[n,t]),n)return g.a.createElement(me,{data:n,roundOver:E,onEndGame:function(){s.push("/game/".concat(n.room.name,"/score"))}});return g.a.createElement("div",null,g.a.createElement("form",{className:"flex flex-row",onSubmit:function(e){var n;e.preventDefault(),fetch((n=l,"https://kha9mwfrdb.execute-api.us-east-1.amazonaws.com/dev/search/".concat(n))).then(function(){var e=Object(o.a)(r.a.mark(function e(n){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:t=e.sent,console.log("here2",t),p({variables:{roomId:a,description:t.description,imageUrl:t.poster,name:t.title,answer:t.reception}}),d(null);case 6:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()).catch(function(e){console.error("error!",e)})}},g.a.createElement("div",{className:"flex flex-row"},g.a.createElement("input",{placeholder:"Search movie titles...",value:l,className:"attached-right shadow-none",onChange:function(e){return d(e.target.value)}}),g.a.createElement("button",{className:"btn attached-left"},"submit"))))},de=function(e){var n=e.data;return g.a.createElement("div",{className:"flex flex-col justify-center items-center w-full pb-0"},g.a.createElement(le,{data:n.questions[n.round],roomId:n.id,nUsers:n.users.length}),g.a.createElement(be,{data:n.questions}),g.a.createElement(se,{data:n.users,responses:u.a([],"responses",n.questions[n.round])}))},be=function(e){var n=e.data,t=Object(h.useContext)(oe).user,a=n.map(function(e){var n=s.a(["responses",s.b({owner:{id:t.id}}),"value"],e),a=s.a(["answer","score","rottenTomatoes"],e);if(m.a(l.a(d.a),[a,n]))return console.log("score....",n,a),re(n,a)});return"score: ".concat(b.a(p.a(f.a,a)))},pe=function(e){e.match.params.name,Object(h.useContext)(oe).user;return"here"},fe=function(e){var n=e.match.params.name,t=Object(i.c)(K,{variables:{name:n}});return t.loading?"Loading...":g.a.createElement(de,{data:t.data.room[0]})},he=function(){var e=Object(h.useState)(),n=Object(c.a)(e,2),t=n[0],a=n[1],r=Object(h.useContext)(oe),o=r.user,s=r.setUser,u=Object(h.useState)(),m=Object(c.a)(u,2),l=m[0],d=m[1],b=Object(h.useState)({}),p=Object(c.a)(b,2),f=p[0],v=p[1],E=Object(j.g)(),w=Object(i.b)(H),O=Object(c.a)(w,2),N=O[0],$=O[1],_=Object(i.a)(V),q=Object(c.a)(_,2),x=q[0],S=q[1],I=Object(i.b)(Z),y=Object(c.a)(I,2),k=y[0],C=y[1];Object(h.useEffect)(function(){S.loading||S.data&&S.data.room.length&&v(S.data.room[0])},[S]),Object(h.useEffect)(function(){f.id&&N({variables:{name:l,roomId:f.id}})},[f.id,l,N]),Object(h.useEffect)(function(){$.data&&s($.data.insert_user.returning[0])},[$.data,s,E]),Object(h.useEffect)(function(){o&&E.push("/game/".concat(o.room.name))},[o,E]),Object(h.useEffect)(function(){C.data&&s(C.data.insert_user.returning[0])},[C,s]);var U=function(e,n){var a=n.name,r=n.code;e.preventDefault(),"join"===t?(x({variables:{name:r}}),d(a)):"create"===t&&k({variables:{userName:a,roomName:r}})};return t?"join"===t?g.a.createElement(ce,{handleSubmit:U}):"create"===t?g.a.createElement(ie,{handleSubmit:U}):void 0:g.a.createElement("div",{className:"px-10"},g.a.createElement("h1",null,"Do you want to play a game?"),g.a.createElement("div",{className:"btn-group"},g.a.createElement("button",{className:"btn",onClick:function(){return a("create")}},"create"),g.a.createElement("button",{className:"btn",onClick:function(){return a("join")}},"join")))},ge=function(e){var n=e.children,t=Object(h.useState)(),a=Object(c.a)(t,2),r=a[0],o=a[1];return g.a.createElement(oe.Provider,{value:{user:r,setUser:o}},n)},ve=function(){var e=[{name:"Carol",id:"carol-id"},{name:"Bob",id:"bob-id"},{name:"Bob",id:"bob-id"},{name:"Bob",id:"bob-id"},{name:"Bob",id:"bob-id"},{name:"Bob",id:"bob-id"}];return g.a.createElement(oe.Provider,{value:{user:{id:"user-id",name:"Frank"}}},g.a.createElement(j.b,{path:"/components/join",component:ce}),g.a.createElement(j.b,{path:"/components/create",component:ie}),g.a.createElement(j.b,{path:"/components/users"},g.a.createElement(se,{data:e})),g.a.createElement(j.b,{path:"/components/question"},g.a.createElement(me,{data:{id:"some-id"}})),g.a.createElement(j.b,{path:"/components/room"},g.a.createElement(de,{data:{name:"ABCD",questions:[{name:"The Matrix",imageUrl:"https://upload.wikimedia.org/wikipedia/en/c/c1/The_Matrix_Poster.jpg",description:'The Matrix is a 1999 science fiction action film[3][4] written and directed by the Wachowskis.[a] It stars Keanu Reeves, Laurence Fishburne, Carrie-Anne Moss, Hugo Weaving, and Joe Pantoliano and is the first installment in the Matrix franchise. It depicts a dystopian future in which humanity is unknowingly trapped inside a simulated reality, the Matrix, created by intelligent machines to distract humans while using their bodies as an energy source.[5] When computer programmer Thomas Anderson, under the hacker alias "Neo", uncovers the truth, he "is drawn into a rebellion against the machines"[5] along with other people who have been freed from the Matrix.',responses:[{owner:{id:"carol-id"}}]}],round:0,users:e}})))},Ee=function(){var e=Object(h.useContext)(oe).user;return g.a.createElement("div",{className:"app"},g.a.createElement(j.b,{path:"/",exact:!0},g.a.createElement(he,null)),g.a.createElement(ve,null),g.a.createElement(ae,{path:"/game/:name",component:fe,loggedIn:!!e}),g.a.createElement(ae,{path:"/game/:name/score",component:pe,loggedIn:!!e}))};var we=document.getElementById("root");w.a.render(g.a.createElement(function(){return g.a.createElement(v.a,{client:C},g.a.createElement(ge,null,g.a.createElement(O.a,{basename:"/"},g.a.createElement(j.d,null,g.a.createElement(Ee,null)))))},null),we)}},[[59,1,2]]]);
//# sourceMappingURL=main.d25a7d38.chunk.js.map