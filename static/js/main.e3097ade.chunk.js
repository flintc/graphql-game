(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{47:function(e,n,t){e.exports=t(68)},62:function(e,n,t){},68:function(e,n,t){"use strict";t.r(n);var a=t(14),r=t(45),o=t(1),u=t.n(o),c=t(36),m=t.n(c),i=t(8),s=t(20),l=t(15),d=t(43),b=t(9),f=t(46),p=t(39),j=t(2),g=t(16),v=t(44),O=new f.a({uri:"https://graphql-number-guessing-game.herokuapp.com/v1/graphql"}),E=new p.a({uri:"wss://graphql-number-guessing-game.herokuapp.com/v1/graphql",options:{reconnect:!0}}),h=Object(b.d)(function(e){var n=e.query,t=Object(j.l)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation},E,O),w=new g.a({link:h,cache:new v.a}),_=t(17),S=t(18),$=t.n(S);function q(){var e=Object(_.a)(["\n  mutation CreateRoom($roomName: String, $userName: String) {\n    insert_room(objects: [{ name: $roomName, users: { data: [{ name: $userName }] } }]) {\n      returning {\n        id\n      }\n      affected_rows\n    }\n  }\n"]);return q=function(){return e},e}function y(){var e=Object(_.a)(["\n  query FindRoomByName($name: String) {\n    room(where: { name: { _eq: $name } }) {\n      id\n      name\n    }\n  }\n"]);return y=function(){return e},e}function I(){var e=Object(_.a)(["\n  subscription SubscribeToRoom($roomId: uuid!) {\n    room_by_pk(id: $roomId) {\n      questions(order_by: { created_at: desc }) {\n        id\n        name\n        created_at\n        answer\n        responses {\n          value\n          owner {\n            name\n          }\n        }\n      }\n      users {\n        id\n        name\n      }\n    }\n  }\n"]);return I=function(){return e},e}function N(){var e=Object(_.a)(["\n  query Room($name: String) {\n    room(where: { name: { _eq: $name } }, distinct_on: name) {\n      id\n      name\n      questions(order_by: { created_at: desc }) {\n        id\n        name\n        created_at\n        answer\n        responses {\n          value\n          owner {\n            name\n          }\n        }\n      }\n      users {\n        id\n        name\n      }\n    }\n  }\n"]);return N=function(){return e},e}function k(){var e=Object(_.a)(["\n  query UsersInRoomQuery($roomName: String) {\n    user(where: { room: { name: { _eq: $roomName } } }) {\n      id\n      name\n    }\n  }\n"]);return k=function(){return e},e}function C(){var e=Object(_.a)(["\n  subscription UsersInRoomSubscription($roomName: String) {\n    user(where: { room: { name: { _eq: $roomName } } }) {\n      id\n      name\n    }\n  }\n"]);return C=function(){return e},e}function R(){var e=Object(_.a)(["\n  mutation CreateUser($name: String, $roomId: uuid) {\n    insert_user(objects: [{ name: $name, room_id: $roomId }]) {\n      affected_rows\n      returning {\n        id\n        name\n        room {\n          name\n          id\n        }\n      }\n    }\n  }\n"]);return R=function(){return e},e}var x=$()(R()),U=$()(C()),D=$()(k()),Q=$()(N()),T=$()(I()),B=$()(y()),F=$()(q()),J=t(32),L=(t(62),u.a.createContext()),M=function(e){var n=e.component,t=e.loggedIn,a=e.path,o=Object(r.a)(e,["component","loggedIn","path"]);return u.a.createElement(l.b,Object.assign({path:a},o,{render:function(e){return t?u.a.createElement(n,e):u.a.createElement(l.a,{to:"/"})}}))},A=function(e){var n=e.handleSubmit,t=Object(o.useState)(null),r=Object(a.a)(t,2),c=r[0],m=r[1],i=Object(o.useState)(null),s=Object(a.a)(i,2),l=s[0],d=s[1];return console.log("name",l),u.a.createElement("form",{onSubmit:function(e){return n(e,{name:l,code:c})}},u.a.createElement("input",{value:l,onChange:function(e){return d(e.target.value)},placeholder:"Name"}),u.a.createElement("input",{value:c,onChange:function(e){return m(e.target.value)},placeholder:"Room Code"}),u.a.createElement("button",null,"submit"))},P=function(e){var n=e.name,t=Object(s.c)(D,{variables:{roomName:n}}),a=t.data,r=t.subscribeToMore,c=t.loading;return Object(o.useEffect)(function(){c||r({document:U,variables:{roomName:n},updateQuery:function(e,n){var t=n.subscriptionData.data;return t?J.a(["user"],t.user,e):e}})},[c,n,r]),c?"Loading...":u.a.createElement("ul",null,a.user.map(function(e){return u.a.createElement("li",{key:e.id},e.name)}))},z=function(e){e.name;var n=Object(o.useContext)(L).user;return u.a.createElement("div",null,u.a.createElement("span",null,n.name,"'s answer:"),u.a.createElement("form",null,u.a.createElement("input",{placeholder:"Answer"})))},G=function(e){var n=e.match.params.name,t=Object(s.c)(Q,{variables:{name:n}}),a=t.data&&t.data.room[0];return Object(o.useEffect)(function(){t.data&&t.subscribeToMore({document:T,variables:{roomId:a.id},updateQuery:function(e,n){var t=n.subscriptionData;return t.data?J.a(["room",0,"users"],t.data.room_by_pk.users,e):e}})},[t,a]),t.loading?"Loading...":u.a.createElement("div",null,u.a.createElement("h1",null,a.name),u.a.createElement("h3",null,a.id),u.a.createElement("h3",null,a.questions[0].name),u.a.createElement(z,null),u.a.createElement(P,{name:n}))},H=function(){var e=Object(o.useState)(),n=Object(a.a)(e,2),t=n[0],r=n[1],c=Object(o.useContext)(L),m=c.user,i=c.setUser,d=Object(o.useState)(),b=Object(a.a)(d,2),f=b[0],p=b[1],j=Object(o.useState)({}),g=Object(a.a)(j,2),v=g[0],O=g[1],E=Object(l.g)(),h=Object(s.b)(F),w=(Object(a.a)(h,1)[0],Object(s.b)(x)),_=Object(a.a)(w,2),S=_[0],$=_[1],q=Object(s.a)(B),y=Object(a.a)(q,2),I=y[0],N=y[1];Object(o.useEffect)(function(){N.loading||N.data&&N.data.room.length&&O(N.data.room[0])},[N]),Object(o.useEffect)(function(){v.id&&S({variables:{name:f,roomId:v.id}})},[v.id,f,S]),Object(o.useEffect)(function(){$.data&&i($.data.insert_user.returning[0])},[$.data,i,E]),Object(o.useEffect)(function(){m&&E.push("/game/".concat(m.room.name))},[m,E]);return t?"join"===t?u.a.createElement(A,{handleSubmit:function(e,n){var a=n.name,r=n.code;e.preventDefault(),"join"===t&&(I({variables:{name:r}}),p(a))}}):void 0:u.a.createElement("div",null,u.a.createElement("button",null,"create"),u.a.createElement("button",{onClick:function(){return r("join")}},"join"))},K=function(e){var n=e.children,t=Object(o.useState)(),r=Object(a.a)(t,2),c=r[0],m=r[1];return u.a.createElement(L.Provider,{value:{user:c,setUser:m}},n)},V=function(){var e=Object(o.useContext)(L).user;return u.a.createElement(u.a.Fragment,null,u.a.createElement(l.b,{path:"/",exact:!0,component:H}),u.a.createElement(M,{path:"/game/:name",component:G,loggedIn:!!e}))};var W=document.getElementById("root");m.a.render(u.a.createElement(function(){return u.a.createElement(i.a,{client:w},u.a.createElement(K,null,u.a.createElement(d.a,{basename:"/"},u.a.createElement(l.d,null,u.a.createElement(V,null)))))},null),W)}},[[47,1,2]]]);
//# sourceMappingURL=main.e3097ade.chunk.js.map